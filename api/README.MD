# Getting Started

### Pre-Requires
- JDK 11
- Maven 3.6.0
- Docker ([Install](https://docs.docker.com/engine/install/ubuntu/ "Install") | [Configure](https://docs.docker.com/v17.09/engine/installation/linux/linux-postinstall/ "Configure"))
- docker-compose ([Install](https://docs.docker.com/compose/install/ "Install"))

## Clean Architecture
![Alt text](./docs/clean_architecture.png?raw=true "Clean Architecture Cone")

## Packages structure
![Alt text](./docs/packages_clean_architecture.png?raw=true "Clean Architecture Cone")

* businessrule -> Use case, i.e. the application's business rules.
    - dto -> Middle classes created to group multiple objects into one.
    - exception -> Package where the custom exceptions is.
    - gateway -> Package where the interface calls the repository to connect external applications, i.e. usecase call the database.
    - message -> message service used by the validator, e.g. read the error message and get a appropriate message to that error.
    - usecase -> Package where all usecase is.
    - validator -> Package with custom validations, e.g. AutoInsuranceValidator is used to validate the input params in the API.


* domain -> Domain entities, i.e. related to the domain's business rules.


* external -> Items related to the most external part of the application, i.e. items related to the application it self.
    - configuration -> Items related to the application's configuration in general, i.e. database configuration, cache configuration.


* interfaceadapter -> Items related to the user's access, i.e. Controllers, Gateways, Repositories and Delegate.
    - delegate -> Intended to implement the delegate classes auto generated by the openAPI generator, i.e. it delegates the responsability to the usecase.
    - gateway -> Implements the gateway interface used in the businessrule package.
    - mapper -> Used to suit the domain object comming from the database into the response.
    - repository -> Used to call and get data from the database.
    - util -> Package with utils used in the application.

## Running apllication

```bash
docker-compose -f misc/docker/docker-compose.yml up -d

./mvnw spring-boot:run # or via ide

```

## Endpoints

* Find all questions
```
localhost:8080/questions
```

* Find questions by difficulty
```
localhost:8080/questions/filter/difficulty/{difficulty}
```

* Find questions by operation
```
localhost:8080/questions/filter/operation/{operation}
```

* Find questions by difficulty and operation
```
localhost:8080/questions/filter/{difficulty}/{operation}
```

* Insert Question
```
localhost:8080/addQuestion
```
To insert a question you need to pass the following body:
```
{
"difficulty":"dificil",
"operation" : "multiplicacao",
"equation" : "2*5*9",
"answer" : "90"
}
```

## Removing apllication and reset data on Mongo
```bash
docker-compose -f misc/docker/docker-compose.yml down -v
```

- Mongo Express ([mongo-express](http://localhost:8086 "mongo-express"))
    - user: 'dev', pwd: 'dev!' or user: 'admin', pwd: 'dev!'
    - Note: To access Mongo, it's not necessary run the application, just the Docker.
